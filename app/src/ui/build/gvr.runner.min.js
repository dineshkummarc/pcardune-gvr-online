gvr.runner={Runner:Class.extend({init:function(a,c,b){this.program=a;this.stack=[this.program];this.renderer=c;this.globals={};this.globals[gvr.lang.RUNNER_GLOBAL_KEY]=this;this.timeout=null;this.notify=b||function(d){};this.running=false},printStackTrace:function(){var b=[];for(var a=0;a<this.stack.length;a++){b.push(this.stack[a].name)}return b},step:function(a){this.run(0,a,true)},stop:function(){window.clearTimeout(this.timeout);this.running=false},run:function(g,i,f){this.running=true;var a=g===-1;g=g||200;if(this.stack.length>0){var d=this.stack.pop();try{var b=d.step(this.globals)}catch(h){gvr.alert(h.message);return}this.stack=this.stack.concat(b);if(!a){this.renderer.render()}if(b.length>0){var c=this;if(a){this.run(g,i,f)}else{if(!f){this.timeout=window.setTimeout(function(){c.run(g,i,f)},g)}}}else{this.run(g,i,f)}}else{this.stop();if(this.renderer.world.robot.on){this.stop();gvr.alert("Robot ran out of instructions.")}if(typeof i==="function"){i()}if(a){this.renderer.render()}}}})};